{% extends "democracy/candidate_films_base.html" %}
{% load static %}
{% load staticfiles %}
{% load widget_tweaks %}
{% load i18n %}

{% block title %}{% trans 'Voting results' %}{% endblock %}

{% block content %}


<!--START: HEADER-->
<div class="text-center my-5 mx-3">
  <h4 class="display-4 my-4">{% trans 'Voting results' %}</h4>
  <a href="{% url 'democracy:candidate_films' club.id %}">{% trans 'Go back to candidate films' %}</a>
</div>
<!--END: HEADER-->


<!--START: PARTICIPANTS-->
<div class="text-center mx-3">
  <strong>{% trans 'Participants: ' %}</strong>
  {% for participant in participants %}
  {% if forloop.counter == participants|length %}{{ participant }}{% else %}{{ participant }},{% endif %}
  {% endfor %}
</div>
<!--END: PARTICIPANTS-->


<!--START: WARNINGS-->
{% if warnings %}
{% for warning in warnings %}
<div class="alert alert-warning alert-dismissible fade show text-center my-2" role="alert">
  {% if warning.type == 'veto' %}
  {% blocktrans with user=warning.voter film=warning.film %}
  <strong>{{ user }}</strong> vetoed the film <strong>{{ film }}</strong>
  {% endblocktrans %}
  {% elif warning.type == 'omg' %}
  {% blocktrans with user=warning.voter film=warning.film %}
  Remember that <strong>{{ user }}</strong> really really wants to see <strong>{{ film }}</strong>
  {% endblocktrans %}
  {% endif %}
  <button type="button" class="close" data-dismiss="alert" aria-label="Close">
    <span aria-hidden="true">&times;</span>
  </button>
</div>
{% endfor %}
{% endif %}
<!--END: WARNINGS-->


<!--START: VOTING RESULTS-->
<table class="table table-hover mt-3">
  <thead>
  <tr>
    <th scope="col">{% trans 'Film' %}</th>
    <th scope="col" class="text-center">{% trans 'Score' %}</th>
    <th scope="col" class="text-center"><img style="min-height: 18px;" src="{% static 'democracy/svg/thumbsup.svg'%}">
    </th>
    <th scope="col" class="text-center"><img style="min-height: 18px;" src="{% static 'democracy/svg/thumbsdown.svg'%}">
    </th>
    <th scope="col" class="text-center">{% trans "Didn't vote" %}</th>
  </tr>
  </thead>
  <tbody>
  {% for film_results in films_results|dictsortreversed:"points" %}

  {% if forloop.counter == 1 %}
  <tr class="table-success">
    <td><a href="{% url 'democracy:film_detail' club.id film_results.id %}">{{ film_results.title }}</a></td>
    <td class="text-center">{{ film_results.points }}</td>

    {% elif film_results.veto %}
  <tr class="table-danger">
    <td><a href="{% url 'democracy:film_detail' club.id film_results.id %}">{{ film_results.title }}</a></td>
    <td class="text-center">- âˆž</td>

    {% else %}
  <tr>
    <td><a href="{% url 'democracy:film_detail' club.id film_results.id %}">{{ film_results.title }}</a></td>
    <td class="text-center">{{ film_results.points }}</td>

    {% endif %}
    <td class="text-center">
      {% for voter in film_results.positive_voters %}
      {% if forloop.counter == film_results.positive_voters|length %}{{ voter }}{% else %}{{ voter }},{% endif %}
      {% endfor %}
    </td>
    <td class="text-center">
      {% for voter in film_results.negative_voters %}
      {% if forloop.counter == film_results.negative_voters|length %}{{ voter }}{% else %}{{ voter }},{% endif %}
      {% endfor %}
    </td>
    <td class="text-center">
      {% for voter in film_results.no_voters %}
      {% if forloop.counter == film_results.no_voters|length %}{{ voter }}{% else %}{{ voter }},{% endif %}
      {% endfor %}
    </td>
  </tr>

  {% endfor %}
  </tbody>
</table>
<!--END: VOTING RESULTS-->


{% endblock %}